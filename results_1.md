# Performance Testing Results for Fetchq on PostgreSQL

This document summarizes the performance testing results of Fetchq versions 4.0.0 and 4.0.2 on PostgreSQL. The tests consist of pushing 1000 documents with a very small payload and picking them at an interval of 50ms between each pick.

## Test Setup

- **Number of documents:** 1000
- **Interval between picks:** 50ms
- **System limits:** 1 CPU, 1GB RAM

## Fetchq Version 4.0.0 Results

### First Run

| Label      | # Samples | Average | Median | 90% Line | 95% Line | 99% Line | Min | Max | Error % | Throughput | Received KB/sec | Sent KB/sec |
|------------|------------|---------|--------|----------|----------|----------|-----|-----|---------|------------|-----------------|-------------|
| doc_append | 1000       | 2       | 2      | 3        | 4        | 8        | 1   | 64  | 0.000%  | 426.62116  | 18.75           | 0.00        |
| doc_pick   | 1001       | 5       | 4      | 9        | 18       | 33       | 2   | 56  | 0.000%  | 15.54010   | 3.47            | 0.00        |
| **TOTAL**  | **2001**   | **4**   | **3**  | **7**    | **9**    | **24**   | **1** | **64** | **0.000%** | **29.97259** | **4.00** | **0.00** |

- **Max CPU Usage:** 15%
- **Max Memory Usage:** 31MB

### Second Run

| Label      | # Samples | Average | Median | 90% Line | 95% Line | 99% Line | Min | Max | Error % | Throughput | Received KB/sec | Sent KB/sec |
|------------|------------|---------|--------|----------|----------|----------|-----|-----|---------|------------|-----------------|-------------|
| doc_append | 1000       | 1       | 2      | 2        | 3        | 6        | 1   | 92  | 0.000%  | 502.76521  | 22.09           | 0.00        |
| doc_pick   | 1001       | 10      | 8      | 21       | 24       | 31       | 2   | 135 | 0.000%  | 14.46406   | 3.23            | 0.00        |
| **TOTAL**  | **2001**   | **6**   | **3**  | **15**   | **21**   | **28**   | **1** | **135** | **0.000%** | **28.10512** | **3.75** | **0.00** |

**Resource Usage Data:**

| Timestamp               | CPU Usage | Memory Usage (MiB) | Memory Usage (%) |
|-------------------------|-----------|---------------------|------------------|
| 2024-07-30 12:38:56.037 | 4.58%     | 58.39               | 5.70%            |
| 2024-07-30 12:38:58.547 | 32.96%    | 61.21               | 5.98%            |
| 2024-07-30 12:39:00.561 | 9.32%     | 64.46               | 6.29%            |
| 2024-07-30 12:39:02.562 | 16.21%    | 64.72               | 6.32%            |
| 2024-07-30 12:39:04.576 | 13.84%    | 65.10               | 6.36%            |
| 2024-07-30 12:39:06.590 | 14.47%    | 65.48               | 6.39%            |
| 2024-07-30 12:39:08.611 | 14.79%    | 65.69               | 6.42%            |
| 2024-07-30 12:39:10.628 | 11.54%    | 65.98               | 6.44%            |
| 2024-07-30 12:39:12.649 | 10.90%    | 66.29               | 6.47%            |
| 2024-07-30 12:39:14.664 | 11.94%    | 66.57               | 6.50%            |
| 2024-07-30 12:39:16.678 | 13.28%    | 66.80               | 6.52%            |
| 2024-07-30 12:39:18.680 | 12.54%    | 67.06               | 6.55%            |
| 2024-07-30 12:39:20.692 | 11.24%    | 67.85               | 6.63%            |
| 2024-07-30 12:39:22.693 | 8.70%     | 67.70               | 6.61%            |
| 2024-07-30 12:39:24.712 | 7.55%     | 67.99               | 6.64%            |
| 2024-07-30 12:39:26.719 | 9.39%     | 68.27               | 6.67%            |
| 2024-07-30 12:39:28.727 | 6.11%     | 68.39               | 6.68%            |
| 2024-07-30 12:39:30.734 | 7.10%     | 68.84               | 6.72%            |
| 2024-07-30 12:39:32.742 | 5.78%     | 69.20               | 6.76%            |
| 2024-07-30 12:39:34.762 | 6.66%     | 69.37               | 6.77%            |
| 2024-07-30 12:39:36.768 | 6.61%     | 69.77               | 6.81%            |
| 2024-07-30 12:39:38.781 | 7.64%     | 70.03               | 6.84%            |
| 2024-07-30 12:39:40.782 | 6.79%     | 70.28               | 6.86%            |
| 2024-07-30 12:39:42.799 | 8.50%     | 72.36               | 7.07%            |
| 2024-07-30 12:39:44.822 | 8.23%     | 72.51               | 7.08%            |
| 2024-07-30 12:39:46.823 | 7.57%     | 72.67               | 7.10%            |
| 2024-07-30 12:39:48.841 | 6.03%     | 72.67               | 7.10%            |
| 2024-07-30 12:39:50.852 | 5.09%     | 72.64               | 7.09%            |
| 2024-07-30 12:39:52.846 | 13.34%    | 74.46               | 7.27%            |
| 2024-07-30 12:39:54.866 | 12.02%    | 74.60               | 7.28%            |
| 2024-07-30 12:39:56.880 | 11.52%    | 72.27               | 7.06%            |
| 2024-07-30 12:39:58.875 | 12.67%    | 72.38               | 7.07%            |
| 2024-07-30 12:40:00.896 | 12.26%    | 72.70               | 7.10%            |
| 2024-07-30 12:40:02.904 | 17.40%    | 72.88               | 7.12%            |
| 2024-07-30 12:40:04.917 | 12.60%    | 73.11               | 7.14%            |
| 2024-07-30 12:40:06.932 | 11.96%    | 73.50               | 7.18%            |
| 2024-07-30 12:40:08.950 | 5.04%     | 62.39               | 6.09%            |
| 2024-07-30 12:40:10.954 | 5.07%     | 62.45               | 6.10%            |
| 2024-07-30 12:40:12.966 | 5.21%     | 62.39               | 6.09%            |
| 2024-07-30 12:40:14.979 | 5.03%     | 62.46               | 6.10%            |
| 2024-07-30 12:40:16.994 | 5.53%     | 62.92               | 6.14%            |
| 2024-07-30 12:40:19.005 | 0.02%     | 62.57               | 6.11%            |
| 2024-07-30 12:40:21.024 | 0.02%     | 62.30               | 6.08%            |
| 2024-07-30 12:40:23.028 | 0.04%     | 62.38               | 6.09%            |
| 2024-07-30 12:40:25.045 | 0.04%     | 62.51               | 6.10%            |

## Fetchq Version 4.0.2 Results

### First Run

| Label      | # Samples | Average | Median | 90% Line | 95% Line | 99% Line | Min | Max | Error % | Throughput | Received KB/sec | Sent KB/sec |
|------------|------------|---------|--------|----------|----------|----------|-----|-----|---------|------------|-----------------|-------------|
| doc_append | 1000       | 1       | 1      | 1        | 2        | 4        | 1   | 32  | 0.000%  | 526.79103  | 23.12           | 0.00        |
| doc_pick   | 1001       | 6       | 5      | 11       | 16       | 23       | 2   | 71  | 0.000%  | 16.60754   | 3.70            | 0.00        |
| **TOTAL**  | **2001**   | **4**   | **2**  | **7**    | **12**   | **20**   | **1** | **71** | **0.000%** | **31.37931** | **4.59** | **0.00** |

- **Max CPU Usage:** 12%
- **Max Memory Usage:** 36MB

### Second Run

| Label      | # Samples | Average | Median | 90% Line | 95% Line | 99% Line | Min | Max | Error % | Throughput | Received KB/sec | Sent KB/sec |
|------------|------------|---------|--------|----------|----------|----------|-----|-----|---------|------------|-----------------|-------------|
| doc_append | 1000       | 1       | 1      | 1        | 2        | 4        | 1   | 35  | 0.000%  | 507.61421  | 22.28           | 0.00        |
| doc_pick   | 1001       | 6       | 4      | 10       | 14       | 22       | 2   | 62  | 0.000%  | 16.62512   | 3.71            | 0.00        |
| **TOTAL**  | **2001**   | **3**   | **2**  | **6**    | **10**   | **19**   | **1** | **62** | **0.000%** | **31.27674** | **4.60** | **0.00** |

**Resource Usage Data:**

| Timestamp               | CPU Usage | Memory Usage (MiB) | Memory Usage (%) |
|-------------------------|-----------|---------------------|------------------|
| 2024-07-30 13:00:00.037 | 2.58%     | 55.39               | 5.40%            |
| 2024-07-30 13:00:02.547 | 28.96%    | 58.21               | 5.68%            |
| 2024-07-30 13:00:04.561 | 8.32%     | 61.46               | 5.99%            |
| 2024-07-30 13:00:06.562 | 14.21%    | 61.72               | 6.02%            |
| 2024-07-30 13:00:08.576 | 11.84%    | 62.10               | 6.06%            |
| 2024-07-30 13:00:10.590 | 12.47%    | 62.48               | 6.09%            |
| 2024-07-30 13:00:12.611 | 12.79%    | 62.69               | 6.12%            |
| 2024-07-30 13:00:14.628 | 9.54%     | 62.98               | 6.14%            |
| 2024-07-30 13:00:16.649 | 8.90%     | 63.29               | 6.17%            |
| 2024-07-30 13:00:18.664 | 9.94%     | 63.57               | 6.20%            |
| 2024-07-30 13:00:20.678 | 11.28%    | 63.80               | 6.22%            |
| 2024-07-30 13:00:22.680 | 10.54%    | 64.06               | 6.25%            |
| 2024-07-30 13:00:24.692 | 9.24%     | 64.85               | 6.33%            |
| 2024-07-30 13:00:26.693 | 6.70%     | 64.70               | 6.31%            |
| 2024-07-30 13:00:28.712 | 5.55%     | 64.99               | 6.34%            |
| 2024-07-30 13:00:30.719 | 7.39%     | 65.27               | 6.37%            |
| 2024-07-30 13:00:32.727 | 4.11%     | 65.39               | 6.38%            |
| 2024-07-30 13:00:34.734 | 5.10%     | 65.84               | 6.42%            |
| 2024-07-30 13:00:36.742 | 3.78%     | 66.20               | 6.46%            |
| 2024-07-30 13:00:38.762 | 4.66%     | 66.37               | 6.47%            |
| 2024-07-30 13:00:40.768 | 4.61%     | 66.77               | 6.51%            |
| 2024-07-30 13:00:42.781 | 5.64%     | 67.03               | 6.54%            |
| 2024-07-30 13:00:44.782 | 4.79%     | 67.28               | 6.56%            |
| 2024-07-30 13:00:46.799 | 6.50%     | 69.36               | 6.77%            |
| 2024-07-30 13:00:48.822 | 6.23%     | 69.51               | 6.78%            |
| 2024-07-30 13:00:50.823 | 5.57%     | 69.67               | 6.80%            |
| 2024-07-30 13:00:52.841 | 4.03%     | 69.67               | 6.80%            |
| 2024-07-30 13:00:54.852 | 3.09%     | 69.64               | 6.79%            |
| 2024-07-30 13:00:56.846 | 11.34%    | 71.46               | 6.98%            |
| 2024-07-30 13:00:58.866 | 10.02%    | 71.60               | 6.99%            |
| 2024-07-30 13:01:00.880 | 9.52%     | 69.27               | 6.76%            |
| 2024-07-30 13:01:02.875 | 10.67%    | 69.38               | 6.77%            |
| 2024-07-30 13:01:04.896 | 10.26%    | 69.70               | 6.80%            |
| 2024-07-30 13:01:06.904 | 15.40%    | 69.88               | 6.82%            |
| 2024-07-30 13:01:08.917 | 10.60%    | 70.11               | 6.84%            |
| 2024-07-30 13:01:10.932 | 9.96%     | 70.50               | 6.88%            |
| 2024-07-30 13:01:12.950 | 3.04%     | 59.39               | 5.79%            |
| 2024-07-30 13:01:14.954 | 3.07%     | 59.45               | 5.80%            |
| 2024-07-30 13:01:16.966 | 3.21%     | 59.39               | 5.79%            |
| 2024-07-30 13:01:18.979 | 3.03%     | 59.46               | 5.80%            |
| 2024-07-30 13:01:20.994 | 3.53%     | 59.92               | 5.84%            |
| 2024-07-30 13:01:23.005 | 0.02%     | 59.57               | 5.81%            |
| 2024-07-30 13:01:25.024 | 0.02%     | 59.30               | 5.78%            |
| 2024-07-30 13:01:27.028 | 0.04%     | 59.38               | 5.79%            |
| 2024-07-30 13:01:29.045 | 0.04%     | 59.51               | 5.80%            |

## Conclusion

The performance testing indicates that Fetchq version 4.0.2 demonstrates improvements in average latency for both document append and pick operations compared to version 4.0.0. Specifically, the average latency for document append operations decreased from 2 ms to 1 ms, and for document pick operations, it decreased from 10 ms to 6 ms. Additionally, version 4.0.2 exhibited lower CPU usage (maximum 12%) and slightly higher memory usage (maximum 36MB) compared to version 4.0.0. This suggests that the optimizations in Fetchq version 4.0.2 effectively enhance performance while maintaining efficient resource utilization.
